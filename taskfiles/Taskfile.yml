version: '3'

env:
  ROOT_DIR: "{{.PWD}}"
  ENV: '{{ default "development"  .ENV }}'

# dotenv: ['./.env', './.env.secrets']
dotenv: ['./.env']

includes:

  vault:
    taskfile: taskfiles/vault.Taskfile.yml


tasks:

  test:
    desc: tests environment variables
    cmds:
      - echo "{{.PROJECT_NAME}}"

  start:
    desc: start nocodb docker
    cmds:
      - task: restart

  stop:
    desc: stop nocodb docker
    cmds:
      - cd ./docker-compose/pg && docker-compose down

  upgrade-restart:
    desc: upgrade and restart nocodb docker
    cmds:
      - docker pull nocodb/nocodb:latest
      - docker pull postgres:latest
      - task: restart

  restart:
    desc: restart nocodb docker
    cmds:
      - task: stop
      - cd ./docker-compose/pg && docker-compose up -d

  # docs:
  #   desc: run docs server at http://127.0.0.1:8000/
  #   cmds:
  #     # - pip install mkdocs mkdocs-materialq
  #     - pipenv install mkdocs mkdocs-material
  #     - source .env
  #     - mkdocs serve --open
  #   aliases: [doc]

  # install_dependencies:
  #   desc: "Install necessary dependencies using Brew"
  #   cmds:
  #     - "arch -arm64 brew bundle"
  #     - pipenv install --dev
  #   aliases: [install]